<!doctype html>
<html>
	<head lang="en">
		<meta charset="utf-8" />
		<script src="sdpi-components.js"></script>
	</head>

	<body>
		<sdpi-item label="Icon">
			<sdpi-select
				hot-reload="true"
				placeholder="Please choose the type of icon you want"
				datasource="getIconSettings"
				setting="iconSettings"
			/>
		</sdpi-item>

		<sdpi-item label="Settings to Show">
			<sdpi-checkbox-list columns="2" datasource="getSettings" hot-reload="true" setting="objectSettings" />
		</sdpi-item>
	</body>
</html>

<script>
	const { streamDeckClient } = SDPIComponents;
	streamDeckClient.sendToPropertyInspector.subscribe((ev) => {
		const { payload } = ev;
		if (payload.event === 'getSettings') {
			let checkedAtInit = []
			payload.items.forEach((item) => {
				if (item.checked) {
					checkedAtInit = checkedAtInit.concat(item.value)
				}
			});
			
			document.querySelector('[setting="objectSettings"]').value = checkedAtInit
		}
	})
</script>
